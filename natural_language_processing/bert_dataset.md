 ```mermaid
graph TD
    A["14.9 用于预训练BERT的数据集"] --> B["为预训练任务定义辅助函数"]
    B --> B1["数据加载函数"]
    B1 --> B1a["文本读取"]
    B1 --> B1b["数据清洗"]
    B1 --> B1c["格式转换"]
    B1 --> B1d["批处理"]
    
    B --> B2["预处理函数"]
    B2 --> B2a["分词处理"]
    B2 --> B2b["特殊标记"]
    B2 --> B2c["填充截断"]
    B2 --> B2d["掩码生成"]
    
    B --> B3["训练函数"]
    B3 --> B3a["损失计算"]
    B3 --> B3b["优化器设置"]
    B3 --> B3c["学习率调度"]
    B3 --> B3d["早停机制"]
    
    A --> C["将文本转换为预训练数据集"]
    C --> C1["数据集构建"]
    C1 --> C1a["原始文本"]
    C1 --> C1b["句子对"]
    C1 --> C1c["掩码文本"]
    C1 --> C1d["标签生成"]
    
    C --> C2["数据增强"]
    C2 --> C2a["随机掩码"]
    C2 --> C2b["句子交换"]
    C2 --> C2c["同义词替换"]
    C2 --> C2d["噪声注入"]
    
    C --> C3["数据验证"]
    C3 --> C3a["格式检查"]
    C3 --> C3b["质量评估"]
    C3 --> C3c["分布分析"]
    C3 --> C3d["错误处理"]
    
    A --> D["数据集选择"]
    D --> D1["通用语料库"]
    D1 --> D1a["Wikipedia"]
    D1 --> D1b["BookCorpus"]
    D1 --> D1c["Common Crawl"]
    D1 --> D1d["新闻语料"]
    
    D --> D2["领域语料库"]
    D2 --> D2a["医学文本"]
    D2 --> D2b["法律文本"]
    D2 --> D2c["科技文献"]
    D2 --> D2d["社交媒体"]
    
    D --> D3["多语言语料库"]
    D3 --> D3a["多语言Wikipedia"]
    D3 --> D3b["多语言新闻"]
    D3 --> D3c["翻译语料"]
    D3 --> D3d["平行语料"]
    
    A --> E["数据预处理"]
    E --> E1["文本清洗"]
    E1 --> E1a["HTML标签移除"]
    E1 --> E1b["特殊字符处理"]
    E1 --> E1c["标点符号处理"]
    E1 --> E1d["大小写统一"]
    
    E --> E2["分词处理"]
    E2 --> E2a["WordPiece分词"]
    E2 --> E2b["子词切分"]
    E2 --> E2c["特殊标记添加"]
    E2 --> E2d["词表构建"]
    
    E --> E3["数据格式化"]
    E3 --> E3a["输入格式"]
    E3 --> E3b["标签格式"]
    E3 --> E3c["掩码格式"]
    E3 --> E3d["分段格式"]
    
    A --> F["数据加载与批处理"]
    F --> F1["数据加载器"]
    F1 --> F1a["批大小设置"]
    F1 --> F1b["数据打乱"]
    F1 --> F1c["并行加载"]
    F1 --> F1d["内存优化"]
    
    F --> F2["批处理策略"]
    F2 --> F2a["动态填充"]
    F2 --> F2b["长度排序"]
    F2 --> F2c["批内平衡"]
    F2 --> F2d["批间平衡"]
    
    F --> F3["数据缓存"]
    F3 --> F3a["内存缓存"]
    F3 --> F3b["磁盘缓存"]
    F3 --> F3c["分布式缓存"]
    F3 --> F3d["缓存更新"]
    
    A --> G["注意事项"]
    G --> G1["数据质量"]
    G1 --> G1a["文本质量"]
    G1 --> G1b["领域覆盖"]
    G1 --> G1c["数据平衡"]
    G1 --> G1d["噪声处理"]
    
    G --> G2["计算资源"]
    G2 --> G2a["存储空间"]
    G2 --> G2b["内存使用"]
    G2 --> G2c["计算效率"]
    G2 --> G2d["分布式处理"]
    
    G --> G3["应用限制"]
    G3 --> G3a["领域适应"]
    G3 --> G3b["多语言支持"]
    G3 --> G3c["实时性要求"]
    G3 --> G3d["资源限制"] 